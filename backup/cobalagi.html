<!DOCTYPE html>
<html>

<head>
    <title>Counter Detik</title>

</head>

<body onload="checkTime()">

    <h1>Counter Detik</h1>
    <button onclick="startCounter()">Mulai</button>
    <button onclick="stopCounter()">Stop</button>
    <button onclick="resetCounter()">Reset</button>
    <p>Counter: <span id="counterDisplay">0</span> detik</p>

    <h1>Counter Detik 2</h1>
    <button onclick="startCounter2()">Mulai</button>
    <p>Counter: <span id="counterDisplay2">0</span> detik</p>

    <h1>Counter Detik 3</h1>
    <button onclick="startCounter3()">Mulai</button>
    <p>Counter: <span id="counterDisplay3">0</span> detik</p>

    <h1>Counter Detik 4</h1>
    <button onclick="startCounter4()">Mulai</button>
    <p>Counter: <span id="counterDisplay4">0</span> detik</p>

    <h1>Counter Detik 5</h1>
    <button onclick="startCounter5()">Mulai</button>
    <p>Counter: <span id="counterDisplay5">0</span> detik</p>

    <h1>Counter Detik 6 </h1>
    <button onclick="startCounter6()">Mulai</button>
    <p>Counter: <span id="counterDisplay6">0</span> detik</p>

    <h1>Counter Detik 7</h1>
    <button onclick="startCounter7()">Mulai</button>
    <p>Counter: <span id="counterDisplay7">0</span> detik</p>

    <h1>Counter Detik 8</h1>
    <button onclick="startCounter8()">Mulai</button>
    <p>Counter: <span id="counterDisplay8">0</span> detik</p>


    <script>
        var counter = 0;
        var counter2 = 0;
        var counter3 = 0;
        var counter4 = 0;
        var counter5 = 0;
        var counter6 = 0;
        var counter7 = 0;
        var counter8 = 0;


        var intervalId;
        var intervalId2;
        var intervalId3;
        var intervalId4;
        var intervalId5;
        var intervalId6;
        var intervalId7;
        var intervalId8;


        // Mengambil nilai terakhir dari penyimpanan lokal saat halaman dimuat
        window.onload = function () {
            var storedCounter = localStorage.getItem("counter");
            var storedCounter2 = localStorage.getItem("counter2");
            var storedCounter3 = localStorage.getItem("counter3");
            var storedCounter4 = localStorage.getItem("counter4");
            var storedCounter5 = localStorage.getItem("counter5");
            var storedCounter6 = localStorage.getItem("counter6");
            var storedCounter7 = localStorage.getItem("counter7");
            var storedCounter8 = localStorage.getItem("counter8");


            var storedIntervalStatus = localStorage.getItem("intervalStatus");
            var storedIntervalStatus2 = localStorage.getItem("intervalStatus2");
            var storedIntervalStatus3 = localStorage.getItem("intervalStatus3");
            var storedIntervalStatus4 = localStorage.getItem("intervalStatus4");
            var storedIntervalStatus5 = localStorage.getItem("intervalStatus5");
            var storedIntervalStatus6 = localStorage.getItem("intervalStatus6");
            var storedIntervalStatus7 = localStorage.getItem("intervalStatus7");
            var storedIntervalStatus8 = localStorage.getItem("intervalStatus8");


            if (storedCounter) {
                counter = parseInt(storedCounter);
                displayCounter();
                if (storedIntervalStatus === "running") {
                    startCounter();
                }
            }
            if (storedCounter2) {
                counter2 = parseInt(storedCounter2);
                displayCounter2();
                if (storedIntervalStatus2 === "running") {
                    startCounter2();
                }
            }
            if (storedCounter3) {
                counter3 = parseInt(storedCounter3);
                displayCounter3();
                if (storedIntervalStatus3 === "running") {
                    startCounter3();
                }
            }
            if (storedCounter4) {
                counter4 = parseInt(storedCounter4);
                displayCounter4();
                if (storedIntervalStatus4 === "running") {
                    startCounter4();
                }
            }
            if (storedCounter5) {
                counter5 = parseInt(storedCounter5);
                displayCounter5();
                if (storedIntervalStatus5 === "running") {
                    startCounter5();
                }
            }
            if (storedCounter6) {
                counter6 = parseInt(storedCounter6);
                displayCounter6();
                if (storedIntervalStatus6 === "running") {
                    startCounter6();
                }
            }
            if (storedCounter7) {
                counter7 = parseInt(storedCounter7);
                displayCounter7();
                if (storedIntervalStatus7 === "running") {
                    startCounter7();
                }
            }
            if (storedCounter8) {
                counter8 = parseInt(storedCounter8);
                displayCounter8();
                if (storedIntervalStatus8 === "running") {
                    startCounter8();
                }
            }
        }


        function startCounter() {
            intervalId = setInterval(function () {
                counter++;
                displayCounter();
                saveCounterToDatabase();

            }, 1000);

            localStorage.setItem("intervalStatus", "running");
        }
        function startCounter2() {
            intervalId2 = setInterval(function () {
                counter2++;
                displayCounter2();
                saveCounterToDatabase2();

            }, 1000);

            localStorage.setItem("intervalStatus2", "running");
        }
        function startCounter3() {
            intervalId3 = setInterval(function () {
                counter3++;
                displayCounter3();
                saveCounterToDatabase3();

            }, 1000);

            localStorage.setItem("intervalStatus3", "running");
        }
        function startCounter4() {
            intervalId4 = setInterval(function () {
                counter4++;
                displayCounter4();
                saveCounterToDatabase4();

            }, 1000);

            localStorage.setItem("intervalStatus4", "running");
        }
        function startCounter5() {
            intervalId5 = setInterval(function () {
                counter5++;
                displayCounter5();
                saveCounterToDatabase5();

            }, 1000);

            localStorage.setItem("intervalStatus5", "running");
        }
        function startCounter6() {
            intervalId6 = setInterval(function () {
                counter6++;
                displayCounter6();
                saveCounterToDatabase6();

            }, 1000);

            localStorage.setItem("intervalStatus6", "running");
        }
        function startCounter7() {
            intervalId7 = setInterval(function () {
                counter7++;
                displayCounter7();
                saveCounterToDatabase7();

            }, 1000);

            localStorage.setItem("intervalStatus7", "running");
        }
        function startCounter8() {
            intervalId8 = setInterval(function () {
                counter8++;
                displayCounter8();
                saveCounterToDatabase8();

            }, 1000);

            localStorage.setItem("intervalStatus8", "running");
        }


        function saveCounterToDatabase() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time=' + [counter]);
        }
        function saveCounterToDatabase2() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach2.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time2=' + [counter2]);
        }
        function saveCounterToDatabase3() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach3.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time3=' + [counter3]);
        }
        function saveCounterToDatabase4() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach4.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time4=' + [counter4]);
        }
        function saveCounterToDatabase5() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach5.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time5=' + [counter5]);
        }
        function saveCounterToDatabase6() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach6.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time6=' + [counter6]);
        }
        function saveCounterToDatabase7() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach7.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time7=' + [counter7]);
        }
        function saveCounterToDatabase8() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'dt_mach8.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log('Counter berhasil disimpan ke database.');
                }
            };
            // Mengirim data counter ke PHP
            xhr.send('&time8=' + [counter8]);
        }

        // Menghentikan counter saat tombol "Stop" ditekan
        function stopCounter() {
            clearInterval(intervalId);
            clearInterval(intervalId2);
            clearInterval(intervalId3);
            clearInterval(intervalId4);
            clearInterval(intervalId5);
            clearInterval(intervalId6);
            clearInterval(intervalId7);
            clearInterval(intervalId8);

            // Menyimpan status counter ke penyimpanan lokal saat tombol "Stop" ditekan
            localStorage.setItem("intervalStatus", "stopped");
            localStorage.setItem("intervalStatus2", "stopped");
            localStorage.setItem("intervalStatus3", "stopped");
            localStorage.setItem("intervalStatus4", "stopped");
            localStorage.setItem("intervalStatus5", "stopped");
            localStorage.setItem("intervalStatus6", "stopped");
            localStorage.setItem("intervalStatus7", "stopped");
            localStorage.setItem("intervalStatus8", "stopped");


        }


        // Mengatur ulang counter saat tombol "Reset" ditekan
        function resetCounter() {
            counter = 0;
            counter2 = 0;
            counter3 = 0;
            counter4 = 0;
            counter5 = 0;
            counter6 = 0;
            counter7 = 0;
            counter8 = 0;


            displayCounter();
            displayCounter2();
            displayCounter3();
            displayCounter4();
            displayCounter5();
            displayCounter6();
            displayCounter7();
            displayCounter8();


            clearInterval(intervalId);
            clearInterval(intervalId2);
            clearInterval(intervalId3);
            clearInterval(intervalId4);
            clearInterval(intervalId5);
            clearInterval(intervalId6);
            clearInterval(intervalId7);
            clearInterval(intervalId8);


            // Menghapus nilai dari penyimpanan lokal saat tombol "Reset" ditekan
            localStorage.removeItem("counter");
            localStorage.removeItem("counter2");
            localStorage.removeItem("counter3");
            localStorage.removeItem("counter4");
            localStorage.removeItem("counter5");
            localStorage.removeItem("counter6");
            localStorage.removeItem("counter7");
            localStorage.removeItem("counter8");


            localStorage.removeItem("intervalStatus");
            localStorage.removeItem("intervalStatus2");
            localStorage.removeItem("intervalStatus3");
            localStorage.removeItem("intervalStatus4");
            localStorage.removeItem("intervalStatus5");
            localStorage.removeItem("intervalStatus6");
            localStorage.removeItem("intervalStatus7");
            localStorage.removeItem("intervalStatus8");

        }

        // Menyimpan nilai terakhir ke penyimpanan lokal saat halaman akan dimuat ulang atau ditutup
        window.onbeforeunload = function () {
            localStorage.setItem("counter", counter);
            localStorage.setItem("counter2", counter2);
            localStorage.setItem("counter3", counter3);
            localStorage.setItem("counter4", counter4);
            localStorage.setItem("counter5", counter5);
            localStorage.setItem("counter6", counter6);
            localStorage.setItem("counter7", counter7);
            localStorage.setItem("counter8", counter8);

        }


        // Memperbarui tampilan HTML dengan nilai counter saat ini
        function displayCounter() {
            var display = document.getElementById("counterDisplay");
            display.innerHTML = counter;
        }
        function displayCounter2() {
            var display2 = document.getElementById("counterDisplay2");
            display2.innerHTML = counter2;
        }
        function displayCounter3() {
            var display3 = document.getElementById("counterDisplay3");
            display3.innerHTML = counter3;
        }
        function displayCounter4() {
            var display4 = document.getElementById("counterDisplay4");
            display4.innerHTML = counter4;
        }
        function displayCounter5() {
            var display5 = document.getElementById("counterDisplay5");
            display5.innerHTML = counter5;
        }
        function displayCounter6() {
            var display6 = document.getElementById("counterDisplay6");
            display6.innerHTML = counter6;
        }
        function displayCounter7() {
            var display7 = document.getElementById("counterDisplay7");
            display7.innerHTML = counter7;
        }
        function displayCounter8() {
            var display8 = document.getElementById("counterDisplay8");
            display8.innerHTML = counter8;
        }
    </script>
    <script>
        function checkTime() {
            var date = new Date();
            var hours = date.getHours();
            var minutes = date.getMinutes();
            var checkStatus = localStorage.getItem("intervalStatus");
            var checkStatus2 = localStorage.getItem("intervalStatus2");
            var checkStatus3 = localStorage.getItem("intervalStatus3");
            var checkStatus4 = localStorage.getItem("intervalStatus4");
            var checkStatus5 = localStorage.getItem("intervalStatus5");
            var checkStatus6 = localStorage.getItem("intervalStatus6");
            var checkStatus7 = localStorage.getItem("intervalStatus7");
            var checkStatus8 = localStorage.getItem("intervalStatus8");

            // var checkStatuson2 = localStorage.getItem("intervalStatus2", "running");
            // var checkStatusoff2 = localStorage.getItem("intervalStatus2", "stopped");
            // var checkStatuson3 = localStorage.getItem("intervalStatus3", "running");
            // var checkStatusoff3 = localStorage.getItem("intervalStatus3", "stopped");
            // var checkStatuson4 = localStorage.getItem("intervalStatus", "running");
            // var checkStatusoff4 = localStorage.getItem("intervalStatus", "stopped");




            if (hours === 21 && minutes === 41) {

                if (checkStatus && checkStatus2 && checkStatus3 && checkStatus4 && checkStatus5 && checkStatus6 && checkStatus7 && checkStatus8 == "stopped") {
                    resetCounter();
                    window.location.href = "login.html";

                } else if (checkStatus == "running") {
                    startCounter();
                    window.location.href = "login.html";

                } else if (checkStatus2 == "running") {
                    startCounter2();
                    window.location.href = "login.html";

                } else if (checkStatus3 == "running") {
                    startCounter3();
                    window.location.href = "login.html";

                } else if (checkStatus4 == "running") {
                    startCounter4();
                    window.location.href = "login.html";

                } else if (checkStatus5 == "running") {
                    startCounter5();
                    window.location.href = "login.html";

                } else if (checkStatus6 == "running") {
                    startCounter6();
                    window.location.href = "login.html";

                } else if (checkStatus7 == "running") {
                    startCounter7();
                    window.location.href = "login.html";

                } else if (checkStatus8 == "running") {
                    startCounter8();
                    window.location.href = "login.html";

                }


            }
        }
        setInterval(checkTime, 60000); // Cek setiap 1 menit
    </script>
</body>

</html>